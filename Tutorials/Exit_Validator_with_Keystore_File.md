# Exit your Validator (full withdrawal)<br>— using the command line interface Ethdo<br>— with only your validator's keystore files

To exit your mainnet validator and have your ETH stake returned to you, you must sign a specific message and publish it to the network. If you have not updated your withdrawal credentials to the new 0x01 format, you will need to do so first before your validator is eligible for exiting (see the Section 1 [tutorials](/../main/README.md)). I've only tested the Ethdo tool on mainnet validators, so this tutorial may not be accurate for signing for testnet validators. This tool is a command line interface, not a GUI. At present, I don't know of a good GUI for exiting validators, that I can trust and recommend.

Before you start, for this process you will need your keystore file that you may have created when you created your validator in the beginning. This file is a JSON file that contains your validator's basic info and its private key, and the file is encrypted with a password you chose. If you don't have this keystore file, you can create/restore it using one of the Section 2 [tutorials](/../main/README.md). If after you locate or recreate the keystore file, you are unsure if it belongs to the specific validator you wish to exit, you can open the file in a text editor (i.e. right-click > Open With > Notepad) and verify the "pubkey" value in the file matches the public key of the validator you wish to exit.

1. Browse to [https://github.com](https://github.com) and find the “wealdtech/ethdo” program, and click on “releases” on the right side of the page. Or navigate to [https://github.com/wealdtech/ethdo/releases](https://github.com/wealdtech/ethdo/releases). The most recent release is at the top. Verisons older than 1.35.0 will not work after the Dencun hardfork ETH network upgrade is official in mid-March 2024. If you would like to read more technical details on the various commands you can use Ethdo with, the source documents specifically related to exiting validators, are here: [https://github.com/wealdtech/ethdo/blob/master/docs/exitingvalidators.md](https://github.com/wealdtech/ethdo/blob/master/docs/exitingvalidators.md).
2. Scroll down to “Assets” and download the version appropriate to your system. This tutorial is written only for Windows systems, so choose the file that ends with “.zip”.
3. In Explorer, locate the compressed zip file you just downloaded, and extract the contents. To easily extract compressed files in Windows, right click on the file and select <code>Extract All...</code>.
4. Within the new folder you just extracted the files to, navigate in until you find the “ethdo.exe” file, and move that file to any folder of your choice that has a short path that has no spaces in it. You will need to type this path a couple times later, so if it's shorter, your task will be easier.
5. For the next step, you need to be online briefly so the program can download an offline version of a public validator data list, for it to use later. You can skip them if you have already completed steps 5-9.
6. From your start menu, run your Command Prompt app. (Windows PowerShell app works just as well, and has color-coding to make commands easier to read)
7. Type or copy/paste the following command, changing the <code>[FolderPath]</code> to wherever you put that ethdo.exe file, and then press enter:<br><code>[FolderPath]\ethdo.exe validator credentials set --prepare-offline</code><br>For example:<br>![example image](images/CP003.jpg)
8. You will see the following message response: <code>No connection supplied with --connection parameter and no local beacon node found, attempting to use mainnet fallback</code>. It is first attempting to contact your local node, and since you likely are not running a node on your computer, it will automatically switch to accessing the data it needs from the internet using the “mainnet fallback” option. Be patient and wait until it completes and displays this message: <code>offline-preparation.json generated</code>. This may be up to a couple minutes long depending on your internet download speed. It has now downloaded and saved to your harddrive a ~320MB+ JSON database file that contains public data on every validator on the network. It will use this data next, to get certain details of your validator so it can sign the appropriate exit message for you.
    * Do NOT move this file from its current location, or else the following steps will not work as the program won't be able to find it. If you need to move this file between online/offline computers, just make sure this file is placed in whatever folder is the normal Windows Users folder of that computer and the user logged into it. For example, <code>C:\\Users\\KentA\\</code>. (Note: If in doubt, you can identify the Windows Users folder for your machine, by opening a File Explorer window and typing <code>%userprofile%</code> in the box)
    * If Ethdo fails to download this database file for some reason, you can find links to backup copies of the database available for downloading at [https://github.com/eth-educators/ethstaker-guides/blob/main/voluntary-exit.md#prepared-alternative](https://github.com/eth-educators/ethstaker-guides/blob/main/voluntary-exit.md#prepared-alternative). These files are refreshed once per day. If you download the file this way, extract the contents of the zip file to the location described earlier in step 8 above.
10. You are now going to be doing sensitive tasks, so for good security practices, you should now disconnect your computer from the internet or turn off your WiFi. Even better, move the program (a single executable file) to an air-gapped computer for these sensitive operations. If switching computers, you will need to also move the database JSON file created in step 8, and ensure it is located in the correct folder, as described in step 8.
11. Put a copy of your validator's keystore JSON file in the same folder with the ethdo.exe file. The keystore file contains your validator's basic info and its private key, and the file is encrypted with a password you chose.
12. Type or copy/paste the command highlighted below, using the following changes: (Tip: you might find it helpful to prepare this command in a text editor, make the needed changes to customize it, and then copy the final result to the command prompt app)
    * Change both <code>[FolderPath]</code> to wherever you put the ethdo.exe file and your keystore file.
    * Change <code>[Password]</code> to the password you used to encrypt the keystore file when you created it.
    * Change <code>[Keystore.json]</code> to the full filename of the keystore file (including the .json file extension).<br><code>[FolderPath]\ethdo.exe validator exit --offline --passphrase="[Password]" --validator=[FolderPath]\[Keystore.json]</code><br>For example:<br>![example image](images/CP004.jpg)
13. When it completes (<5 seconds usually), you will find a new “exit-operation.json” file created in your personal Windows Users folder (see note in step 8 above). Here's a tip: If you have more keystore files you want to sign exit messages for, rename or move the "exit-operation.json" file so it doesn't get replaced. You can keep the command prompt open and use the "up arrow" key to automatically re-type the last command you ran. Then just backspace out just the filename at the end of that command and replace it with the name of the next keystore file, and press Enter to run the new command. A new "exit-operation.json" file will be created in the same folder and you can move/rename that file too. Keep doing this sequence of actions until you've finished all the keystore files.
14. Go back online (or move the newly-created “exit-operation.json” file or files to your online computer) and navigate to [https://mainnet.beaconcha.in/tools/broadcast](https://mainnet.beaconcha.in/tools/broadcast). (mainnet validators only)
15. Upload the “exit-operation.json” files that you just had created, one at a time, verify that the data in the message corresponds to the validator you wish to exit, and click Submit & Broadcast.
16. The signed exit instruction will now be sent out to a network node. The update should be finalized on the network within 10 minutes.
17. When broadcasted and accepted by a node, you will see your validator move into “Exited” status on your [beaconcha.in](https://beaconcha.in/) validator dashboard page, along with dates and times on the right side of the page showing when your validator is estimated to be next in the exit queue. Exit queues can often be a few days long, so keep your validator running and validating and earning rewards, until your dashboard shows your validator has had its turn to fully exit. Once exited, the validator enters a pause period of about a day, and after that, it gets marked as withdrawable. Your entire stake and any earned rewards not swept out before, will be swept into your wallet when the sweeper is scheduled to come around to this validator next after the withdrawable date.
18. Remember that large database file the program made? If you're done signing validator exit messages, you can delete it now, since you're done with it, and it uses a lot of disk space. It's located in the same folder you found the “exit-operation.json” file, and is called “offline-preparation.json”.

<br>

[Back to Home](/../main/README.md)
